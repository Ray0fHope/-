<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–í—Å–µ–ª–µ–Ω–Ω–∞—è –∑–≤—É–∫–æ–≤</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Orbitron', sans-serif;
            background: linear-gradient(135deg, #1e3a8a, #000);
            overflow: hidden;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            flex-direction: column;
        }
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background: transparent;
            z-index: 1;
        }
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s infinite;
        }
        @keyframes twinkle {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }
        .meteor {
            position: absolute;
            width: 2px;
            height: 20px;
            background: linear-gradient(to bottom, #ff4500, transparent);
            animation: meteorFall 1.5s linear infinite;
        }
        @keyframes meteorFall {
            0% { transform: translate(0, -100%) rotate(45deg); opacity: 1; }
            100% { transform: translate(200px, 100vh) rotate(45deg); opacity: 0; }
        }
        .card {
            animation: fadeIn 0.5s ease-in;
            position: relative;
            background: linear-gradient(135deg, #1e40af, #000);
            border: 2px solid #ff4500;
            padding: 16px;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            max-width: 90%;
            width: 100%;
            text-align: center;
            margin-top: 10px;
            z-index: 2000;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse {
            animation: pulse 1s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        button:hover {
            transform: scale(1.05);
            transition: transform 0.2s;
        }
        button:disabled {
            background-color: #6b7280;
            cursor: not-allowed;
        }
        .progress-container {
            width: 90%;
            position: absolute;
            top: 10px;
            left: 5%;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 2000;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: transparent;
            border: 2px solid #00f;
            border-radius: 10px;
            position: relative;
            box-shadow: 0 0 15px #00f, inset 0 0 5px #00f;
            overflow: hidden;
        }
        .progress-section {
            position: absolute;
            height: 100%;
            background: #00ff00;
            box-shadow: 0 0 10px #00ff00;
            transition: width 0.5s ease-in-out;
        }
        .glow-effect {
            position: absolute;
            height: 100%;
            background: #ffffff;
            opacity: 0;
            animation: glow 0.5s ease-out forwards;
        }
        @keyframes glow {
            0% { opacity: 0.8; box-shadow: 0 0 10px #ffffff, 0 0 20px #ffffff; }
            100% { opacity: 0; box-shadow: none; }
        }
        .progress-label {
            color: #ff4500;
            font-size: 12px;
            text-shadow: 0 0 5px #ff4500;
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            margin-bottom: 5px;
        }
        .score-counter {
            position: absolute;
            top: -30px;
            width: 100%;
            text-align: center;
            color: #ffd700;
            font-size: 18px;
            font-weight: bold;
            text-shadow: 0 0 10px #ff4500, 0 0 15px #ff4500;
            background: rgba(0, 0, 0, 0.5);
            padding: 5px;
            border-radius: 5px;
            animation: scorePulse 0.5s ease-in-out;
        }
        @keyframes scorePulse {
            0%, 100% { transform: scale(1); text-shadow: 0 0 10px #ff4500, 0 0 15px #ff4500; }
            50% { transform: scale(1.1); text-shadow: 0 0 15px #ff4500, 0 0 20px #ff4500; }
        }
        .progress-mark {
            position: absolute;
            height: 100%;
            width: 2px;
            background: #fff;
            opacity: 0.8;
        }
        .bonus-message {
            position: absolute;
            top: -50px;
            width: 100%;
            text-align: center;
            color: #00ff00;
            font-size: 14px;
            text-shadow: 0 0 5px #00ff00;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #00ff00;
            animation: fadeOut 2s ease-out forwards;
            z-index: 2001;
        }
        @keyframes fadeOut {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }
        .rocket-final {
            position: absolute;
            font-size: 20px;
            filter: drop-shadow(0 0 5px #ff4500);
            transition: left 2s ease-out, opacity 2s ease-out;
            z-index: 2000;
        }
        .rocket-final.flying {
            left: 100%;
            opacity: 0;
        }
        .celebration-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ffd700;
            opacity: 0.9;
            border-radius: 50%;
            animation: fallConfetti 2s ease-out forwards;
        }
        @keyframes fallConfetti {
            0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
        .quiz-container {
            background-color: #ffffff;
            padding: 16px;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            max-width: 90%;
            width: 100%;
            text-align: center;
            position: relative;
            z-index: 2000;
        }
        .title-large {
            font-size: 1.5rem;
            font-weight: bold;
            color: #dc2626;
            margin-bottom: 12px;
        }
        .title-medium {
            font-size: 1.25rem;
            font-weight: bold;
            color: #dc2626;
            margin-bottom: 12px;
        }
        .text-medium {
            font-size: 1rem;
            color: #d1d5db;
            margin-bottom: 16px;
        }
        .text-large {
            font-size: 1.125rem;
            color: #d1d5db;
            margin-bottom: 12px;
        }
        .text-xlarge {
            font-size: 1.75rem;
            font-weight: bold;
            color: #facc15;
            margin-bottom: 16px;
        }
        .option-button {
            background-color: #1e40af;
            color: #ffffff;
            padding: 8px;
            border-radius: 8px;
            margin: 5px 0;
            border: none;
            cursor: pointer;
            touch-action: manipulation;
            width: 100%;
            white-space: normal;
            word-wrap: break-word;
            overflow: hidden;
            text-overflow: ellipsis;
            display: inline-block;
            vertical-align: top;
            max-width: 98%;
            box-sizing: border-box;
        }
        .option-button:hover {
            filter: brightness(1.1);
        }
        .option-button.correct {
            background-color: #00ff00;
            animation: correctPulse 0.5s ease-in-out;
        }
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            justify-content: center;
            width: 100%;
        }
        .input-field {
            width: 100%;
            padding: 10px;
            border: 1px solid #dc2626;
            border-radius: 8px;
            margin-bottom: 12px;
            font-size: 1rem;
            color: #ffffff;
            background-color: #1f2937;
            outline: none;
        }
        .input-field:focus {
            ring: 2px;
            ring-color: #dc2626;
        }
        .button-primary {
            background-color: #dc2626;
            color: #ffffff;
            padding: 10px;
            border-radius: 8px;
            width: 100%;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            touch-action: manipulation;
            margin-top: 16px;
        }
        .button-primary:hover {
            filter: brightness(1.1);
        }
        .button-restart {
            background-color: #dc2626;
            color: #ffffff;
            padding: 10px;
            border-radius: 8px;
            width: 180px;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            touch-action: manipulation;
        }
        .button-restart:hover {
            filter: brightness(1.1);
        }
        .button-restart.return-base {
            margin-top: 10px;
        }
        .flex-col-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .rocket {
            position: absolute;
            font-size: 20px;
            filter: drop-shadow(0 0 5px #ff4500);
            transition: left 0.5s ease-in-out;
            bottom: -5px;
            z-index: 2000;
        }
        .block-buttons {
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .total-score {
            position: relative;
            top: -60px;
            width: 100%;
            text-align: center;
            color: #ffd700;
            font-size: 18px;
            font-weight: bold;
            text-shadow: 0 0 10px #ff4500, 0 0 15px #ff4500;
            background: rgba(0, 0, 0, 0.5);
            padding: 5px;
            border-radius: 5px;
            animation: pulse 1s ease-in-out infinite;
            z-index: 2001;
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    <div id="root"></div>
    <script>
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤–µ–∑–¥ –∏ –º–µ—Ç–µ–æ—Ä–æ–≤
        const starsContainer = document.getElementById('stars');
        for (let i = 0; i < 100; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            star.style.width = `${Math.random() * 3}px`;
            star.style.height = star.style.width;
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 100}%`;
            star.style.animationDelay = `${Math.random() * 2}s`;
            starsContainer.appendChild(star);
        }
        for (let i = 0; i < 10; i++) {
            const meteor = document.createElement('div');
            meteor.className = 'meteor';
            meteor.style.left = `${Math.random() * 100}%`;
            meteor.style.top = `${Math.random() * -50}%`;
            meteor.style.animationDelay = `${Math.random() * 3}s`;
            starsContainer.appendChild(meteor);
        }

        // Web Audio API
        let audioContext;
        try {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        } catch (e) {
            console.error('–û—à–∏–±–∫–∞ Web Audio API:', e);
        }

        function playSound(frequency, duration, type = 'square', volume = 0.03335) {
            if (!audioContext) return;
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            oscillator.type = type;
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            oscillator.start();
            oscillator.stop(audioContext.currentTime + duration);
        }

        function playSequence(frequencies, durationPerNote, type = 'square', volume = 0.03335) {
            if (!audioContext) return;
            frequencies.forEach((freq, index) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                oscillator.type = type;
                oscillator.frequency.setValueAtTime(freq, audioContext.currentTime + index * durationPerNote);
                gainNode.gain.setValueAtTime(volume, audioContext.currentTime + index * durationPerNote);
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                oscillator.start(audioContext.currentTime + index * durationPerNote);
                oscillator.stop(audioContext.currentTime + (index + 1) * durationPerNote);
            });
        }

        const allQuestions = [
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–õ–æ–∂–∫–∞"?', correct_answer: "–∫–æ—à–∫–∞", options: ["—Å–æ–±–∞–∫–∞", "–∫–æ—à–∫–∞", "–º—ã—à–∫–∞", "—Å—Ç–æ–ª"], points: 10 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–î–∏–≤–∞–Ω"?', correct_answer: "—Ç—É–º–∞–Ω", options: ["–∫–æ—Ç", "—Ç—É–º–∞–Ω", "—Å—Ç—É–ª", "–ª–∞–º–ø–∞"], points: 8 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ –Ω–∞—á–∞–ª–µ —Å–ª–æ–≤–∞ "—Å–ª–æ–Ω"?', correct_answer: "—Å", options: ["–ª", "—Å", "–Ω", "–æ"], points: 9 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ –∫–æ–Ω—Ü–µ —Å–ª–æ–≤–∞ "–≥–ª–∞–∑"?', correct_answer: "—Å", options: ["–≥", "–∞", "–∑", "—Å"], points: 7 },
            { question: '–ö–∞–∫–∞—è –≥–ª–∞—Å–Ω–∞—è –ø–æ–¥ —É–¥–∞—Ä–µ–Ω–∏–µ–º –≤ "–¢–µ–ª–µ–≤–∏–∑–æ—Ä"?', correct_answer: "–∏", options: ["–µ", "–∏", "–æ", "—Ä"], points: 10 },
            { question: '–ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∑–≤—É–∫ –≤ "–î–æ–º" –Ω–∞ "—Ç"?'  , correct_answer: "—Ç–æ–º", options: ["–∫–æ–º", "—Ç–æ–º", "—Å–æ–º", "–∫–æ–º"], points: 8 },
            { question: '–ù–∞–∑–æ–≤–∏ —Å–ª–æ–≤–æ, –Ω–∞—á–∏–Ω–∞—é—â–µ–µ—Å—è –Ω–∞ –∑–≤—É–∫ "–°–¢"', start_sound: "—Å—Ç", options: [], points: 12 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Å "—á" –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ?', correct_answer: "–∫–æ—á–µ—Ä–≥–∞", options: ["—Å–æ–±–∞–∫–∞", "—Å—Ç–æ–ª", "–º—ã—à–∫–∞", "–∫–æ—á–µ—Ä–≥–∞"], points: 9 },
            { question: '–ß—Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è, –µ—Å–ª–∏ –∫ "–†—ã–±–∞" –¥–æ–±–∞–≤–∏—Ç—å "–∫"?', correct_answer: "—Ä—ã–±–∞–∫", options: ["—Ä—ã–±–∞–∫", "—Ä—ã–±–∞", "—Ä—ã–±–∫–∞", "—Ä—ã–±–æ–∫"], points: 8 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ "–∞"?', correct_answer: "–ª—É–Ω–∞", options: ["–∫–æ—Ç", "–¥–æ–º", "–ª—É–Ω–∞", "–ª–µ—Å"], points: 7 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–Å–ª–∫–∞"?', correct_answer: "—á—ë–ª–∫–∞", options: ["—Ç—Ä–∞–≤–∞", "—á–µ–ª–∫–∞", "—á—ë–ª–∫–∞", "–æ–∫–Ω–æ"], points: 9 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Å–ª–æ–≤–∞ "–º–µ–¥"?', correct_answer: "–µ", options: ["–º", "–µ", "–¥", "–æ"], points: 8 },
            { question: '–ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∑–≤—É–∫ –≤ "–õ–µ—Å" –Ω–∞ "–≤"?', correct_answer: "–≤–µ—Å", options: ["–≤–µ—Å", "–ª–µ—Å", "–∫–µ—Å", "—Ä–µ—Å"], points: 10 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ –Ω–∞—á–∞–ª–µ —Å–ª–æ–≤–∞ "–ø—Ç–∏—Ü–∞"?', correct_answer: "–ø", options: ["—Ç", "–∏", "—Ü", "–ø"], points: 7 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–†—É–±–∞—à–∫–∞"?', correct_answer: "–±—É–∫–∞—à–∫–∞", options: ["–º–∞—à–∏–Ω–∞", "—Å—Ç–æ–ª–∏–∫", "–±—É–∫–∞—à–∫–∞", "–¥–µ—Ä–µ–≤–æ"], points: 9 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ –∫–æ–Ω—Ü–µ —Å–ª–æ–≤–∞ "–∫–æ—Ç"?', correct_answer: "—Ç", options: ["–∫", "–æ", "—Ç", "–∞"], points: 8 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ –Ω–∞—á–∞–ª–µ —Å–ª–æ–≤–∞ "—Ä–∞–∫–µ—Ç–∞"?', correct_answer: "—Ä", options: ["–∞", "–∫", "–µ", "—Ä"], points: 10 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ "–ó–≤"?', correct_answer: "–∑–≤–µ–∑–¥–∞", options: ["–ª—É–Ω–∞", "–∑–≤–µ–∑–¥–∞", "—Å–æ–ª–Ω—Ü–µ", "–∑–≤–µ–∑–¥–∞"], points: 9 },
            { question: '–ß—Ç–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–ü–µ—Å"?', correct_answer: "–ª–µ—Å", options: ["–¥–æ–º", "—Å–æ–Ω", "–∫–æ—Ç", "–ª–µ—Å"], points: 8 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Å–ª–æ–≤–∞ "–ª—É–Ω–∞"?', correct_answer: "—É", options: ["–ª", "—É", "–Ω", "–∞"], points: 7 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–°–ª–æ–Ω"?', correct_answer: "—Å–æ–Ω", options: ["—Å–æ–Ω", "–¥–æ–º", "–ª–µ—Å", "—Ä–µ–∫–∞"], points: 9 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ –∫–æ–Ω—Ü–µ —Å–ª–æ–≤–∞ "–∑–≤–µ–∑–¥–∞"?', correct_answer: "–∞", options: ["–∑", "–∞", "–µ", "–≤"], points: 8 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ –Ω–∞—á–∞–ª–µ —Å–ª–æ–≤–∞ "—Å–≤–µ—Ç"?', correct_answer: "—Å", options: ["–≤", "–µ", "—Ç", "—Å"], points: 10 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ –∫–æ–Ω—Ü–µ —Å–ª–æ–≤–∞ "–¥–æ–º"?', correct_answer: "–º", options: ["–æ", "–¥", "–∞", "–º"], points: 7 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–ó–≤–µ–∑–¥–∞"?', correct_answer: "–±–µ–¥–∞", options: ["–ª—É–Ω–∞", "–ø—Ç–∏—Ü–∞", "–≥–æ—Ä–∞", "–±–µ–¥–∞"], points: 9 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–ö–æ—Å–º–æ—Å"?', correct_answer: "–≥–æ–ª–æ—Å", options: ["–≥–æ–ª–æ—Å", "–∑–≤—É–∫", "–æ–≥–æ–Ω—å", "–≤–æ–¥–∞"], points: 8 },
            { question: '–ß—Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è –∏–∑ "–ú—è—Ç" —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º "–∞"?', correct_answer: "–º—è—Ç–∞", options: ["–¥–∞—Ç–∞", "–º—è—Ç–∞", "–º–∞—Ç—ã", "–∫–∞—Ç–∞"], points: 10 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Å "—Ä" –≤ –Ω–∞—á–∞–ª–µ?', correct_answer: "—Ä–∞–∫–µ—Ç–∞", options: ["–ª—É–Ω–∞", "–∫–ª—É–±–æ–∫", "–∑–≤–µ–∑–¥–∞", "—Ä–∞–∫–µ—Ç–∞"], points: 9 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–ì–∞—Ä–º–æ—à–∫–∞"?', correct_answer: "–∫–∞—Ä—Ç–æ—à–∫–∞", options: ["—è–±–ª–æ–∫–æ", "–∫–∞—Ä—Ç–æ—à–∫–∞", "—Ü–≤–µ—Ç–æ–∫", "—Å—Ç–æ–ª"], points: 8 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–†–µ–∫–∞"?', correct_answer: "—Ä—É–∫–∞", options: ["–∫–æ–º–æ–∫", "–ª–µ—Å", "–¥–æ–º", "—Ä—É–∫–∞"], points: 7 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–ú—è—á"?', correct_answer: "–ø–ª–∞—á", options: ["—Å–º–µ—Ö", "–∏–≥—Ä–∞", "–ø–ª–∞—á", "—Å–æ–Ω"], points: 9 },
            { question: '–ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∏—Ñ–º—É–µ—Ç—Å—è —Å "–°–≤–µ—Ç"?', correct_answer: "—Ü–≤–µ—Ç", options: ["–¥–µ–Ω—å", "—Ü–≤–µ—Ç", "–Ω–æ—á—å", "–æ–≥–æ–Ω—å"], points: 8 },
            { question: '–ö–∞–∫–æ–π –∑–≤—É–∫ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Å–ª–æ–≤–∞ "–∫–æ—Ç–∏–∫"?', correct_answer: "—Ç", options: ["–∫", "–æ", "—Ç", "–∏"], points: 10 }
        ];

        // Shuffle and assign questions
        const shuffledQuestions = [...allQuestions].sort(() => Math.random() - 0.5);
        const block1Questions = shuffledQuestions.slice(0, 11);
        const block2Questions = shuffledQuestions.slice(11, 22);
        const block3Questions = shuffledQuestions.slice(22, 33);

        const blockTasks = {
            block1: block1Questions.map((task, index) => ({ ...task, category: 'block1', localIndex: index })),
            block2: block2Questions.map((task, index) => ({ ...task, category: 'block2', localIndex: index })),
            block3: block3Questions.map((task, index) => ({ ...task, category: 'block3', localIndex: index }))
        };

        const questionsPerBlock = 11;
        const maxPointsPerBlock = 100;

        function ErrorMessage({ message }) {
            return React.createElement(
                'div',
                { className: 'quiz-container card' },
                React.createElement('h1', { className: 'title-large' }, 'üöÄ –û—à–∏–±–∫–∞!'),
                React.createElement('p', { className: 'text-medium' }, message)
            );
        }

        function RocketFinal({ isFlying }) {
            return React.createElement(
                'div',
                { className: `rocket-final ${isFlying ? 'flying' : ''}`, style: { left: '0%' } },
                'üöÄ'
            );
        }

        function CelebrationFallback({ show }) {
            if (!show) return null;
            const confetti = Array.from({ length: 200 }).map((_, i) =>
                React.createElement('div', {
                    key: `confetti-${i}`,
                    className: 'confetti',
                    style: {
                        left: `${Math.random() * 100}%`,
                        animationDelay: `${Math.random() * 1}s`,
                        animationDuration: `${1.5 + Math.random() * 1}s`
                    }
                })
            );
            return React.createElement('div', { className: 'celebration-container' }, confetti);
        }

        function QuizApp() {
            const [currentTaskIndex, setCurrentTaskIndex] = React.useState(0);
            const [userAnswer, setUserAnswer] = React.useState('');
            const [score, setScore] = React.useState(0);
            const [isStarted, setIsStarted] = React.useState(false);
            const [currentBlock, setCurrentBlock] = React.useState(null);
            const [isFinished, setIsFinished] = React.useState(false);
            const [error, setError] = React.useState(null);
            const [rocketPosition, setRocketPosition] = React.useState(0);
            const [isRocketFlying, setIsRocketFlying] = React.useState(false);
            const [glowKey, setGlowKey] = React.useState(0);
            const [scoreKey, setScoreKey] = React.useState(0);
            const [bonusMessage, setBonusMessage] = React.useState(null);
            const [bonusKey, setBonusKey] = React.useState(0);
            const [totalBonusPoints, setTotalBonusPoints] = React.useState(0);
            const [showFireworks, setShowFireworks] = React.useState(false);
            const [blockProgress, setBlockProgress] = React.useState({ block1: 0, block2: 0, block3: 0 });
            const [showBlockCelebration, setShowBlockCelebration] = React.useState(false);
            const [blockScores, setBlockScores] = React.useState({ block1: 0, block2: 0, block3: 0 });
            const finalScreenRef = React.useRef(null);

            const tasks = currentBlock ? blockTasks[currentBlock] : [];
            const sectionWidth = 100 / questionsPerBlock;
            const filledSections = blockProgress[currentBlock] || 0;

            const getQuestionNumberInBlock = () => {
                return blockProgress[currentBlock] + 1;
            };

            const resetState = (block) => {
                setIsStarted(true);
                setCurrentBlock(block);
                setCurrentTaskIndex(0);
                setScore(0);
                setUserAnswer('');
                setIsFinished(false);
                setError(null);
                setRocketPosition(0);
                setIsRocketFlying(false);
                setGlowKey(0);
                setScoreKey(0);
                setBonusMessage(null);
                setBonusKey(0);
                setTotalBonusPoints(0);
                setShowFireworks(false);
                setShowBlockCelebration(false);
                let newBlockProgress = { ...blockProgress };
                newBlockProgress[block] = 0;
                setBlockProgress(newBlockProgress);
                let newBlockScores = { ...blockScores };
                newBlockScores[block] = 0;
                setBlockScores(newBlockScores);
            };

            const handleStart = (block) => {
                if (audioContext && audioContext.state === 'suspended') {
                    audioContext.resume().then(() => {
                        resetState(block);
                    });
                } else {
                    resetState(block);
                }
            };

            const handleRestart = () => {
                resetState(currentBlock);
            };

            const handleReturnToBase = () => {
                setIsStarted(false);
                setCurrentBlock(null);
                setCurrentTaskIndex(0);
                setScore(0);
                setUserAnswer('');
                setIsFinished(false);
                setError(null);
                setRocketPosition(0);
                setIsRocketFlying(false);
                setGlowKey(0);
                setScoreKey(0);
                setBonusMessage(null);
                setBonusKey(0);
                setTotalBonusPoints(0);
                setShowFireworks(false);
                setShowBlockCelebration(false);
            };

            const triggerCelebration = () => {
                setShowBlockCelebration(true);
                playSequence([440, 554, 659, 880], 0.25, 'square');
                setTimeout(() => setShowBlockCelebration(false), 4000);
            };

            const handleAnswer = (selectedAnswer) => {
                if (!tasks[currentTaskIndex]) {
                    setError('–ó–∞–¥–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
                    return;
                }
                const task = tasks[currentTaskIndex];
                const isCorrect = task.question.startsWith('–ù–∞–∑–æ–≤–∏ —Å–ª–æ–≤–æ')
                    ? selectedAnswer.trim().toLowerCase().startsWith(task.start_sound)
                    : selectedAnswer.trim().toLowerCase() === task.correct_answer.toLowerCase();

                let newScore = score;
                let newTotalBonusPoints = totalBonusPoints;
                let newBlockScores = { ...blockScores };
                if (isCorrect) {
                    const points = task.points;
                    const currentBlockScore = newBlockScores[currentBlock];
                    const pointsToAdd = Math.min(points, maxPointsPerBlock - currentBlockScore);
                    if (pointsToAdd > 0) {
                        newScore += pointsToAdd;
                        newBlockScores[currentBlock] += pointsToAdd;
                    }
                    if (Math.random() < 0.3 && newTotalBonusPoints < maxPointsPerBlock && newBlockScores[currentBlock] < maxPointsPerBlock) {
                        const remainingPoints = maxPointsPerBlock - newBlockScores[currentBlock];
                        const bonusPoints = Math.min(Math.floor(Math.random() * 10) + 5, remainingPoints);
                        if (bonusPoints > 0) {
                            newScore += bonusPoints;
                            newTotalBonusPoints += bonusPoints;
                            newBlockScores[currentBlock] += bonusPoints;
                            setBonusMessage(`–ë–æ–Ω—É—Å: +${bonusPoints} –æ—á–∫–æ–≤!`);
                            setBonusKey(prev => prev + 1);
                        }
                    }
                    setShowFireworks(true);
                    setTimeout(() => setShowFireworks(false), 1000);
                }
                setScore(newScore);
                setTotalBonusPoints(newTotalBonusPoints);
                setBlockScores(newBlockScores);

                let newBlockProgress = { ...blockProgress };
                newBlockProgress[currentBlock]++;
                setBlockProgress(newBlockProgress);
                const nextMark = Math.min(filledSections + 1, questionsPerBlock) * sectionWidth;
                setRocketPosition(nextMark);
                setUserAnswer('');
                setGlowKey(glowKey + 1);
                setScoreKey(scoreKey + 1);

                if (currentTaskIndex + 1 < tasks.length) {
                    setCurrentTaskIndex(currentTaskIndex + 1);
                    setBonusMessage(null);
                } else {
                    triggerCelebration();
                    if (blockProgress.block1 === 11 && blockProgress.block2 === 11 && blockProgress.block3 === 11) {
                        setIsFinished(true);
                    }
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && userAnswer.trim()) handleAnswer(userAnswer);
            };

            React.useEffect(() => {
                if (isFinished) {
                    setTimeout(() => setIsRocketFlying(true), 1000);
                    setTimeout(() => triggerCelebration(), 100);
                }
            }, [isFinished]);

            const getBlockStatus = (block) => {
                return blockProgress[block] === 11 ? (blockScores[block] >= 35 ? '‚úÖ' : '‚ùå') : '';
            };

            if (error) {
                return React.createElement(ErrorMessage, { message: error });
            }

            if (!isStarted) {
                const totalScore = blockScores.block1 + blockScores.block2 + blockScores.block3;
                return [
                    React.createElement(
                        'div',
                        { className: 'total-score' },
                        `–û–±—â–∏–π —Å—á—ë—Ç: ${totalScore}/300`
                    ),
                    React.createElement(
                        'div',
                        { className: 'quiz-container card' },
                        React.createElement('h1', { className: 'title-large' }, 'üöÄ –í—Å–µ–ª–µ–Ω–Ω–∞—è –∑–≤—É–∫–æ–≤'),
                        React.createElement('p', { className: 'text-medium' }, '–í—ã–±–µ—Ä–∏ –ø—É—Ç—å –∏ –Ω–∞—á–Ω–∏ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ!'),
                        React.createElement(
                            'div',
                            { className: 'block-buttons' },
                            React.createElement(
                                'button',
                                { onClick: () => handleStart('block1'), className: 'button-restart' },
                                '–ó–≤—ë–∑–¥–Ω—ã–π –±—É–∫–≤–∞—Ä—å'
                            ),
                            React.createElement(
                                'span',
                                { style: { color: '#ffd700', fontSize: '1.2rem' } },
                                getBlockStatus('block1')
                            )
                        ),
                        React.createElement(
                            'div',
                            { className: 'block-buttons' },
                            React.createElement(
                                'button',
                                { onClick: () => handleStart('block2'), className: 'button-restart' },
                                '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ–≥–∏'
                            ),
                            React.createElement(
                                'span',
                                { style: { color: '#ffd700', fontSize: '1.2rem' } },
                                getBlockStatus('block2')
                            )
                        ),
                        React.createElement(
                            'div',
                            { className: 'block-buttons' },
                            React.createElement(
                                'button',
                                { onClick: () => handleStart('block3'), className: 'button-restart' },
                                '–ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∞–∑–±—É–∫–∞'
                            ),
                            React.createElement(
                                'span',
                                { style: { color: '#ffd700', fontSize: '1.2rem' } },
                                getBlockStatus('block3')
                            )
                        )
                    )
                ];
            }

            if (blockProgress[currentBlock] === 11) {
                const currentBlockScore = blockScores[currentBlock];
                return [
                    React.createElement(
                        'div',
                        { className: 'quiz-container card flex-col-center' },
                        React.createElement('h1', { className: 'title-large' }, 'üéâ –ü–æ–±–µ–¥–∞!'),
                        React.createElement('p', { className: 'text-xlarge' }, '–¢—ã –º–æ–ª–æ–¥–µ—Ü, –ø–æ–ª–µ—Ç–µ–ª–∏ –¥–∞–ª—å—à–µ!'),
                        React.createElement('p', { className: 'text-large pulse' }, `–¢–≤–æ–∏ –±–∞–ª–ª—ã: ${currentBlockScore}/100`),
                        React.createElement(
                            'button',
                            { onClick: handleRestart, className: 'button-restart' },
                            '–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—É—Ç—å'
                        ),
                        React.createElement(
                            'button',
                            { onClick: handleReturnToBase, className: 'button-restart return-base' },
                            '–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –±–∞–∑—É'
                        )
                    ),
                    React.createElement(CelebrationFallback, { show: showBlockCelebration })
                ];
            }

            if (isFinished) {
                const totalScore = blockScores.block1 + blockScores.block2 + blockScores.block3;
                return [
                    React.createElement(
                        'div',
                        { className: 'progress-container' },
                        React.createElement(
                            'div',
                            { className: 'total-score' },
                            `–û–±—â–∏–π —Å—á—ë—Ç: ${totalScore}/300`
                        )
                    ),
                    React.createElement(
                        'div',
                        { ref: finalScreenRef, className: 'quiz-container card flex-col-center' },
                        React.createElement('h1', { className: 'title-large' }, 'üöÄ –ú–∏—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!'),
                        React.createElement('p', { className: 'text-large' }, '–¢—ã –ø—Ä–æ—à—ë–ª –≤—Å–µ –ø—É—Ç–∏!'),
                        React.createElement('p', { className: 'text-xlarge' }, `–ò—Ç–æ–≥: ${totalScore} –±–∞–ª–ª–æ–≤`),
                        React.createElement(
                            'button',
                            { onClick: handleRestart, className: 'button-restart' },
                            '–ù–æ–≤—ã–π –ø–æ–ª—ë—Ç'
                        ),
                        React.createElement(
                            'button',
                            { onClick: handleReturnToBase, className: 'button-restart return-base' },
                            '–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –±–∞–∑—É'
                        )
                    ),
                    React.createElement(CelebrationFallback, { show: showBlockCelebration }),
                    React.createElement(RocketFinal, { isFlying: isRocketFlying })
                ];
            }

            if (!tasks[currentTaskIndex]) {
                return React.createElement(ErrorMessage, { message: '–ó–∞–¥–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ' });
            }

            const task = tasks[currentTaskIndex];
            const questionNumber = getQuestionNumberInBlock();
            return [
                React.createElement(
                    'div',
                    { className: 'progress-container' },
                    React.createElement(
                        'span',
                        { className: 'progress-label' },
                        `–í–æ–ø—Ä–æ—Å ${questionNumber}/${questionsPerBlock}`
                    ),
                    React.createElement(
                        'div',
                        { className: 'progress-bar' },
                        React.createElement(
                            'div',
                            { key: scoreKey, className: 'score-counter' },
                            `–û—á–∫–∏: ${score}`
                        ),
                        bonusMessage
                            ? React.createElement(
                                  'div',
                                  { key: bonusKey, className: 'bonus-message' },
                                  bonusMessage
                              )
                            : null,
                        Array.from({ length: questionsPerBlock - 1 }, (_, i) =>
                            React.createElement('div', {
                                key: i,
                                className: 'progress-mark',
                                style: { left: `${(i + 1) * sectionWidth}%` }
                            })
                        ),
                        React.createElement(
                            'div',
                            {
                                className: 'progress-section',
                                style: {
                                    width: `${filledSections * sectionWidth}%`
                                }
                            },
                            React.createElement('div', {
                                key: glowKey,
                                className: 'glow-effect',
                                style: {
                                    width: `${sectionWidth}%`
                                }
                            }),
                            React.createElement(
                                'div',
                                {
                                    className: 'rocket',
                                    style: { left: `${rocketPosition}%` }
                                },
                                'üöÄ'
                            )
                        )
                    )
                ),
                React.createElement(
                    'div',
                    { className: 'quiz-container card flex-col-center' },
                    React.createElement('h1', { className: 'title-medium' }, `–ú–∏—Å—Å–∏—è ${questionNumber}`),
                    React.createElement('p', { className: 'text-medium' }, task.question),
                    task.question.startsWith('–ù–∞–∑–æ–≤–∏ —Å–ª–æ–≤–æ')
                        ? [
                            React.createElement('input', {
                                type: 'text',
                                value: userAnswer,
                                onChange: (e) => setUserAnswer(e.target.value),
                                onKeyPress: handleKeyPress,
                                className: 'input-field',
                                placeholder: '–¢–≤–æ–π –æ—Ç–≤–µ—Ç',
                                autoFocus: true,
                                key: 'input'
                            }),
                            React.createElement(
                                'button',
                                {
                                    onClick: () => handleAnswer(userAnswer),
                                    disabled: !userAnswer.trim(),
                                    className: 'button-primary',
                                    key: 'submit'
                                },
                                '–û—Ç–ø—Ä–∞–≤–∏—Ç—å'
                            )
                          ]
                        : React.createElement(
                            'div',
                            { className: 'options-grid' },
                            task.options.map((option, index) =>
                                React.createElement(
                                    'button',
                                    {
                                        key: index,
                                        onClick: () => handleAnswer(option),
                                        className: `option-button ${userAnswer === option && task.correct_answer === option.toLowerCase() ? 'correct' : ''}`,
                                        disabled: userAnswer !== ''
                                    },
                                    option.length > 10 ? option.substring(0, 10) + '...' : option
                                )
                            )
                        ),
                    !task.question.startsWith('–ù–∞–∑–æ–≤–∏ —Å–ª–æ–≤–æ')
                        ? React.createElement(
                            'button',
                            {
                                onClick: () => handleAnswer(userAnswer),
                                disabled: !userAnswer.trim(),
                                className: 'button-primary'
                            },
                            '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å'
                        )
                        : null,
                    showFireworks ? React.createElement(CelebrationFallback, { show: true }) : null
                )
            ];
        }

        if (typeof React === 'undefined' || typeof ReactDOM === 'undefined') {
            document.getElementById('root').innerHTML = `
                <div class="quiz-container card">
                    <h1 class="title-large">üöÄ –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞</h1>
                    <p class="text-medium">–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞—á–∞—Ç—å –º–∏—Å—Å–∏—é. –ü—Ä–æ–≤–µ—Ä—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É!</p>
                </div>
            `;
        } else {
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(React.createElement(QuizApp));
        }
    </script>
</body>
</html>